---
import Layout from '../layouts/Layout.astro';
import Sidebar from '../components/Sidebar.astro';
import { sanityClient } from '../lib/sanity';

// 1. BUSCA OS POSTS NO SANITY (Dinâmico)
const posts = await sanityClient.fetch(`*[_type == "post"] | order(publishedAt desc) {
  title,
  "slug": slug.current,
  "category": categories[0]->title,
  "image": mainImage.asset->url,
  publishedAt
}`);

// O primeiro post da lista vira o destaque (Hero)
const heroPost = posts[0];
// Os outros posts vão para a listagem inferior
const otherPosts = posts.slice(1);
---

<Layout title="Bora Jogador | O Melhor do Futebol">
  
  <div class="w-full max-w-[1200px] mx-auto my-8 flex justify-center px-4">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-5066122308491062"
         data-ad-slot="4803145127"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script is:inline>
         (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div>

  {heroPost && (
    <section class="relative w-full h-[500px] mb-12 border-b-4 border-bj-neon">
      <div class="absolute inset-0">
        <img src={heroPost.image} class="w-full h-full object-cover" alt={heroPost.title}>
        <div class="absolute inset-0 bg-gradient-to-t from-bj-black via-bj-black/70 to-transparent"></div>
      </div>

      <div class="absolute bottom-0 left-0 w-full p-6 md:p-12 z-10">
        <span class="bg-bj-neon text-bj-black text-xs font-bold px-3 py-1 uppercase mb-4 inline-block tracking-wider font-heading">Destaque da Rodada</span>
        <h1 class="text-3xl md:text-6xl font-heading font-bold text-bj-white uppercase leading-none mb-4 max-w-4xl drop-shadow-lg">
          <a href={`/posts/${heroPost.slug}`} class="hover:text-bj-neon transition-colors">
              {heroPost.title}
          </a>
        </h1>
        <a href={`/posts/${heroPost.slug}`} class="inline-block bg-bj-white text-bj-black font-heading font-bold uppercase px-8 py-3 hover:bg-bj-neon transition-colors">
          Ler Matéria Completa
        </a>
      </div>
    </section>
  )}

  <div class="grid grid-cols-1 lg:grid-cols-12 gap-12 px-4 md:px-8">
    <div class="lg:col-span-8 space-y-12">
      <div class="flex items-center justify-between border-b border-white/10 pb-4 mb-8">
        <h2 class="text-3xl font-heading font-bold text-bj-white italic uppercase">
          Últimas <span class="text-bj-neon">Notícias</span>
        </h2>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        {otherPosts.map((post) => (
          <article class="flex flex-col h-full hover:bg-white/5 transition-colors p-3 rounded-sm border border-transparent hover:border-white/10 group">
            <a href={`/posts/${post.slug}`} class="aspect-video overflow-hidden mb-4 border border-white/5 relative block">
              <span class="absolute top-2 left-2 bg-bj-black/90 text-bj-neon text-[10px] font-bold px-2 py-1 uppercase z-10 border border-bj-neon/30">
                {post.category || 'Futebol'}
              </span>
              <img src={post.image} alt={post.title} class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" />
            </a>
            
            <h3 class="text-xl font-heading font-bold text-bj-white leading-tight mb-2">
              <a href={`/posts/${